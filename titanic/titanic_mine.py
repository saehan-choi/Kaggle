import torch
import numpy as np
import pandas as pd
from torch import optim
from model import *
# from torch.nn.modules.activation import ReLU, Sigmoid

X_train = pd.read_csv('./input/train.csv')
X_test = pd.read_csv('./input/test.csv')
Y_train = pd.read_csv('./input/train.csv')
Y_test = pd.read_csv('./input/test.csv')

Y_train = Y_train[['Survived','Age','Embarked']]
Y_test = Y_test[['Survived','Age','Embarked']]

X_train = X_train[['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Embarked']]
X_test = X_test[['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Embarked']]
# print(X_train)
# 여기서 파일내부를 숫자로 바꾸어야함! neural net 예측을위해서 필수적.
X_train.dropna(subset=['Age','Embarked'], inplace=True)
X_test.dropna(subset=['Age','Embarked'], inplace=True)
Y_train.dropna(subset=['Age','Embarked'], inplace=True)
Y_test.dropna(subset=['Age','Embarked'], inplace=True)
# nan 제거작업


Y_train = Y_train['Survived']
Y_test = Y_test['Survived']

for i in range(len(X_train)):
    if X_train.iloc[i,1] == 'female':
        X_train.iloc[i,1] = 1
    elif X_train.iloc[i,1] == 'male':
        X_train.iloc[i,1] = 0

for i in range(len(X_train)):
    if X_train.iloc[i,6] == "S":
        X_train.iloc[i,6] = 1
    elif X_train.iloc[i,6] == "Q":
        X_train.iloc[i,6] = 2
    elif X_train.iloc[i,6] == "C":
        X_train.iloc[i,6] = 3

for i in range(len(X_test)):
    if X_test.iloc[i,1] == 'female':
        X_test.iloc[i,1] = 1
    elif X_test.iloc[i,1] == 'male':
        X_test.iloc[i,1] = 0

for i in range(len(X_test)):
    if X_test.iloc[i,6] == "S":
        X_test.iloc[i,6] = 1
    elif X_test.iloc[i,6] == "Q":
        X_test.iloc[i,6] = 2
    elif X_test.iloc[i,6] == "C":
        X_test.iloc[i,6] = 3



X_train = X_train.values
X_test = X_test.values
Y_train = Y_train.values
Y_test = Y_test.values

X_train = np.array(X_train,dtype=np.float32)
X_test = np.array(X_test,dtype=np.float32)
Y_train = np.array(Y_train,dtype=np.float32)
Y_test = np.array(Y_test,dtype=np.float32)

X_train = torch.from_numpy(X_train)
X_test = torch.from_numpy(X_test)
Y_train = torch.from_numpy(Y_train)
Y_test = torch.from_numpy(Y_test)

device = torch.device('cuda')
net = NeuralNet()
net = net.to(device)


criterion = nn.CrossEntropyLoss().cuda()
optimizer = optim.Adam(net.parameters(),lr=1e-5)
num_epochs = 500

for epochs in range(num_epochs):

    for i in range(len(X_train)):
        pred = X_train[i][:]
        label = Y_train[i]

        running_loss = 0.0
        pred, label = pred.to(device), label.to(device, dtype=torch.long)
        pred, label = pred.unsqueeze(0), label.unsqueeze(0)
        optimizer.zero_grad()
        outputs = net(pred)
        loss = criterion(outputs, label)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()

    with torch.no_grad():
        cnt = 0
        for j in range(len(X_test)):
            
            pred = X_test[j][:]
            label = Y_test[j]
            acc = 0
            pred, label = pred.to(device), label.to(device, dtype=torch.long)
            pred, label = pred.unsqueeze(0), label.unsqueeze(0)
            outputs = net(pred)
            _, predicted = torch.max(outputs,1)
            label, _ = torch.max(label,0)
            if predicted == label:
                cnt+=1
        print(f'accuracy:{cnt/len(X_test)*100}%')

    print(f'epochs : {epochs} loss : {running_loss}')



# accuracy:63.25301204819277%
# epochs : 0 loss : 0.40004950761795044
# accuracy:63.25301204819277%
# epochs : 1 loss : 0.3740464746952057
# accuracy:64.1566265060241%
# epochs : 2 loss : 0.35802188515663147
# accuracy:64.45783132530121%
# epochs : 3 loss : 0.3468254804611206
# accuracy:64.1566265060241%
# epochs : 4 loss : 0.3403973877429962
# accuracy:63.85542168674698%
# epochs : 5 loss : 0.33670252561569214
# accuracy:64.1566265060241%
# epochs : 6 loss : 0.3339824974536896
# accuracy:63.85542168674698%
# epochs : 7 loss : 0.3318839967250824
# accuracy:63.55421686746988%
# epochs : 8 loss : 0.33035969734191895
# accuracy:63.55421686746988%
# epochs : 9 loss : 0.32878121733665466
# accuracy:63.25301204819277%
# epochs : 10 loss : 0.3275425136089325
# accuracy:63.25301204819277%
# epochs : 11 loss : 0.3265790641307831
# accuracy:63.25301204819277%
# epochs : 12 loss : 0.3258075416088104
# accuracy:63.25301204819277%
# epochs : 13 loss : 0.32516393065452576
# accuracy:63.25301204819277%
# epochs : 14 loss : 0.3246631324291229
# accuracy:62.951807228915655%
# epochs : 15 loss : 0.3241574764251709
# accuracy:62.951807228915655%
# epochs : 16 loss : 0.3238348662853241
# accuracy:62.951807228915655%
# epochs : 17 loss : 0.32356172800064087
# accuracy:62.951807228915655%
# epochs : 18 loss : 0.32336798310279846
# accuracy:63.25301204819277%
# epochs : 19 loss : 0.3230968713760376
# accuracy:63.25301204819277%
# epochs : 20 loss : 0.3228950798511505
# accuracy:63.25301204819277%
# epochs : 21 loss : 0.3228120505809784
# accuracy:63.55421686746988%
# epochs : 22 loss : 0.32274332642555237
# accuracy:63.55421686746988%
# epochs : 23 loss : 0.32270699739456177
# accuracy:64.1566265060241%
# epochs : 24 loss : 0.32272788882255554
# accuracy:64.1566265060241%
# epochs : 25 loss : 0.3227771818637848
# accuracy:64.45783132530121%
# epochs : 26 loss : 0.3228241205215454
# accuracy:64.7590361445783%
# epochs : 27 loss : 0.32296931743621826
# accuracy:64.7590361445783%
# epochs : 28 loss : 0.3231053352355957
# accuracy:65.06024096385542%
# epochs : 29 loss : 0.3232629597187042
# accuracy:65.06024096385542%
# epochs : 30 loss : 0.3234288692474365
# accuracy:65.06024096385542%
# epochs : 31 loss : 0.3236568570137024
# accuracy:65.36144578313254%
# epochs : 32 loss : 0.32392987608909607
# accuracy:65.36144578313254%
# epochs : 33 loss : 0.32425644993782043
# accuracy:65.36144578313254%
# epochs : 34 loss : 0.3246111571788788
# accuracy:65.06024096385542%
# epochs : 35 loss : 0.325014591217041
# accuracy:65.06024096385542%
# epochs : 36 loss : 0.32548269629478455
# accuracy:65.06024096385542%
# epochs : 37 loss : 0.32592448592185974
# accuracy:64.7590361445783%
# epochs : 38 loss : 0.3263992965221405
# accuracy:64.7590361445783%
# epochs : 39 loss : 0.32689908146858215
# accuracy:65.06024096385542%
# epochs : 40 loss : 0.327476441860199
# accuracy:65.36144578313254%
# epochs : 41 loss : 0.3280546963214874
# accuracy:65.36144578313254%
# epochs : 42 loss : 0.32873496413230896
# accuracy:65.36144578313254%
# epochs : 43 loss : 0.3294055461883545
# accuracy:65.36144578313254%
# epochs : 44 loss : 0.3300846517086029
# accuracy:65.36144578313254%
# epochs : 45 loss : 0.33066436648368835
# accuracy:65.36144578313254%
# epochs : 46 loss : 0.3312434256076813
# accuracy:65.36144578313254%
# epochs : 47 loss : 0.33181992173194885
# accuracy:65.36144578313254%
# epochs : 48 loss : 0.33250653743743896
# accuracy:65.66265060240963%
# epochs : 49 loss : 0.33297011256217957
# accuracy:65.66265060240963%
# epochs : 50 loss : 0.33345046639442444
# accuracy:65.96385542168674%
# epochs : 51 loss : 0.3338407874107361
# accuracy:65.96385542168674%
# epochs : 52 loss : 0.33435291051864624
# accuracy:66.26506024096386%
# epochs : 53 loss : 0.33481231331825256
# accuracy:66.56626506024097%
# epochs : 54 loss : 0.3352210223674774
# accuracy:66.56626506024097%
# epochs : 55 loss : 0.3355681896209717
# accuracy:66.56626506024097%
# epochs : 56 loss : 0.3358754813671112
# accuracy:66.56626506024097%
# epochs : 57 loss : 0.33632054924964905
# accuracy:66.56626506024097%
# epochs : 58 loss : 0.33658990263938904
# accuracy:66.56626506024097%
# epochs : 59 loss : 0.3368336856365204
# accuracy:66.56626506024097%
# epochs : 60 loss : 0.33719632029533386
# accuracy:67.16867469879519%
# epochs : 61 loss : 0.33739420771598816
# accuracy:67.46987951807229%
# epochs : 62 loss : 0.337581604719162
# accuracy:67.16867469879519%
# epochs : 63 loss : 0.33772340416908264
# accuracy:67.16867469879519%
# epochs : 64 loss : 0.3378808796405792
# accuracy:67.7710843373494%
# epochs : 65 loss : 0.3380265235900879
# accuracy:67.7710843373494%
# epochs : 66 loss : 0.33820614218711853
# accuracy:67.7710843373494%
# epochs : 67 loss : 0.33837172389030457
# accuracy:67.7710843373494%
# epochs : 68 loss : 0.33862170577049255
# accuracy:67.7710843373494%
# epochs : 69 loss : 0.3388115167617798
# accuracy:67.7710843373494%
# epochs : 70 loss : 0.338797926902771
# accuracy:67.7710843373494%
# epochs : 71 loss : 0.3382710814476013
# accuracy:68.07228915662651%
# epochs : 72 loss : 0.338565468788147
# accuracy:69.57831325301204%
# epochs : 73 loss : 0.33882248401641846
# accuracy:69.87951807228916%
# epochs : 74 loss : 0.33898302912712097
# accuracy:70.48192771084338%
# epochs : 75 loss : 0.33919066190719604
# accuracy:70.48192771084338%
# epochs : 76 loss : 0.3393343389034271
# accuracy:70.78313253012048%
# epochs : 77 loss : 0.3393469750881195
# accuracy:70.78313253012048%
# epochs : 78 loss : 0.33941158652305603
# accuracy:70.78313253012048%
# epochs : 79 loss : 0.3395073711872101
# accuracy:70.78313253012048%
# epochs : 80 loss : 0.33959513902664185
# accuracy:71.08433734939759%
# epochs : 81 loss : 0.3396385908126831
# accuracy:71.98795180722891%
# epochs : 82 loss : 0.3398292064666748
# accuracy:71.98795180722891%
# epochs : 83 loss : 0.3397422134876251
# accuracy:72.28915662650603%
# epochs : 84 loss : 0.3398613929748535
# accuracy:72.28915662650603%
# epochs : 85 loss : 0.3399294316768646
# accuracy:72.28915662650603%
# epochs : 86 loss : 0.3399181365966797
# accuracy:72.28915662650603%
# epochs : 87 loss : 0.339910089969635
# accuracy:72.28915662650603%
# epochs : 88 loss : 0.3399192690849304
# accuracy:71.98795180722891%
# epochs : 89 loss : 0.3398984670639038
# accuracy:72.59036144578313%
# epochs : 90 loss : 0.3398076593875885
# accuracy:72.59036144578313%
# epochs : 91 loss : 0.33977702260017395
# accuracy:72.89156626506023%
# epochs : 92 loss : 0.339695543050766
# accuracy:73.19277108433735%
# epochs : 93 loss : 0.33954980969429016
# accuracy:73.19277108433735%
# epochs : 94 loss : 0.3394928574562073
# accuracy:73.19277108433735%
# epochs : 95 loss : 0.3394524157047272
# accuracy:73.49397590361446%
# epochs : 96 loss : 0.3392839729785919
# accuracy:73.49397590361446%
# epochs : 97 loss : 0.33918124437332153
# accuracy:74.3975903614458%
# epochs : 98 loss : 0.3389423191547394
# accuracy:74.3975903614458%
# epochs : 99 loss : 0.33876699209213257
# accuracy:74.3975903614458%
# epochs : 100 loss : 0.3385920524597168
# accuracy:74.3975903614458%
# epochs : 101 loss : 0.3384380042552948
# accuracy:75.0%
# epochs : 102 loss : 0.33825647830963135
# accuracy:75.30120481927712%
# epochs : 103 loss : 0.3379983901977539
# accuracy:75.6024096385542%
# epochs : 104 loss : 0.33778154850006104
# accuracy:75.6024096385542%
# epochs : 105 loss : 0.33752113580703735
# accuracy:75.6024096385542%
# epochs : 106 loss : 0.33718806505203247
# accuracy:75.6024096385542%
# epochs : 107 loss : 0.33701175451278687
# accuracy:75.6024096385542%
# epochs : 108 loss : 0.3367477357387543
# accuracy:76.20481927710844%
# epochs : 109 loss : 0.3365398943424225
# accuracy:76.20481927710844%
# epochs : 110 loss : 0.3362697958946228
# accuracy:76.20481927710844%
# epochs : 111 loss : 0.3359781503677368
# accuracy:76.20481927710844%
# epochs : 112 loss : 0.33568546175956726
# accuracy:76.20481927710844%
# epochs : 113 loss : 0.3354755640029907
# accuracy:76.50602409638554%
# epochs : 114 loss : 0.33510199189186096
# accuracy:76.80722891566265%
# epochs : 115 loss : 0.334818959236145
# accuracy:76.80722891566265%
# epochs : 116 loss : 0.3344147503376007
# accuracy:76.80722891566265%
# epochs : 117 loss : 0.3341045677661896
# accuracy:77.10843373493977%
# epochs : 118 loss : 0.3338071405887604
# accuracy:77.10843373493977%
# epochs : 119 loss : 0.33338624238967896
# accuracy:77.10843373493977%
# epochs : 120 loss : 0.3331148624420166
# accuracy:78.01204819277109%
# epochs : 121 loss : 0.3328332006931305
# accuracy:78.3132530120482%
# epochs : 122 loss : 0.33251217007637024
# accuracy:78.3132530120482%
# epochs : 123 loss : 0.3322153091430664
# accuracy:78.6144578313253%
# epochs : 124 loss : 0.33184316754341125
# accuracy:78.6144578313253%
# epochs : 125 loss : 0.3314787745475769
# accuracy:78.6144578313253%
# epochs : 126 loss : 0.3311181962490082
# accuracy:78.91566265060241%
# epochs : 127 loss : 0.3307633697986603
# accuracy:78.91566265060241%
# epochs : 128 loss : 0.330430269241333
# accuracy:78.91566265060241%
# epochs : 129 loss : 0.3300940692424774
# accuracy:79.21686746987952%
# epochs : 130 loss : 0.32966190576553345
# accuracy:79.51807228915662%
# epochs : 131 loss : 0.32942697405815125
# accuracy:79.81927710843374%
# epochs : 132 loss : 0.32906374335289
# accuracy:79.81927710843374%
# epochs : 133 loss : 0.3287341892719269
# accuracy:80.42168674698796%
# epochs : 134 loss : 0.3284146785736084
# accuracy:80.42168674698796%
# epochs : 135 loss : 0.328086793422699
# accuracy:80.42168674698796%
# epochs : 136 loss : 0.327726274728775
# accuracy:80.72289156626506%
# epochs : 137 loss : 0.32744672894477844
# accuracy:80.72289156626506%
# epochs : 138 loss : 0.3271586000919342
# accuracy:81.02409638554217%
# epochs : 139 loss : 0.32681670784950256
# accuracy:81.02409638554217%
# epochs : 140 loss : 0.3265317678451538
# accuracy:81.92771084337349%
# epochs : 141 loss : 0.32621505856513977
# accuracy:82.2289156626506%
# epochs : 142 loss : 0.3259350657463074
# accuracy:82.53012048192771%
# epochs : 143 loss : 0.32562127709388733
# accuracy:82.53012048192771%
# epochs : 144 loss : 0.32530224323272705
# accuracy:82.53012048192771%
# epochs : 145 loss : 0.3250328600406647
# accuracy:82.53012048192771%
# epochs : 146 loss : 0.32475221157073975
# accuracy:82.53012048192771%
# epochs : 147 loss : 0.3244918882846832
# accuracy:82.53012048192771%
# epochs : 148 loss : 0.3242742717266083
# accuracy:82.53012048192771%
# epochs : 149 loss : 0.3239983320236206
# accuracy:83.13253012048193%
# epochs : 150 loss : 0.32370299100875854
# accuracy:83.13253012048193%
# epochs : 151 loss : 0.32346633076667786
# accuracy:83.13253012048193%
# epochs : 152 loss : 0.323189377784729
# accuracy:83.13253012048193%
# epochs : 153 loss : 0.322932630777359
# accuracy:83.43373493975903%
# epochs : 154 loss : 0.3226820230484009
# accuracy:83.43373493975903%
# epochs : 155 loss : 0.3224794864654541
# accuracy:83.73493975903614%
# epochs : 156 loss : 0.32225874066352844
# accuracy:83.73493975903614%
# epochs : 157 loss : 0.3220297694206238
# accuracy:83.73493975903614%
# epochs : 158 loss : 0.3218398690223694
# accuracy:84.03614457831326%
# epochs : 159 loss : 0.3216133713722229
# accuracy:84.03614457831326%
# epochs : 160 loss : 0.32142019271850586
# accuracy:84.03614457831326%
# epochs : 161 loss : 0.3212195336818695
# accuracy:84.03614457831326%
# epochs : 162 loss : 0.32097750902175903
# accuracy:84.03614457831326%
# epochs : 163 loss : 0.32083508372306824
# accuracy:84.33734939759037%
# epochs : 164 loss : 0.3206549882888794
# accuracy:84.33734939759037%
# epochs : 165 loss : 0.3204503655433655
# accuracy:84.33734939759037%
# epochs : 166 loss : 0.32029053568840027
# accuracy:84.33734939759037%
# epochs : 167 loss : 0.32010844349861145
# accuracy:84.33734939759037%
# epochs : 168 loss : 0.3199303150177002
# accuracy:84.33734939759037%
# epochs : 169 loss : 0.3197706639766693
# accuracy:84.33734939759037%
# epochs : 170 loss : 0.3196186125278473
# accuracy:84.63855421686746%
# epochs : 171 loss : 0.31945258378982544
# accuracy:84.63855421686746%
# epochs : 172 loss : 0.3192702531814575
# accuracy:84.63855421686746%
# epochs : 173 loss : 0.31914153695106506
# accuracy:84.63855421686746%
# epochs : 174 loss : 0.31898972392082214
# accuracy:84.63855421686746%
# epochs : 175 loss : 0.3188541829586029
# accuracy:84.63855421686746%
# epochs : 176 loss : 0.31870797276496887
# accuracy:84.63855421686746%
# epochs : 177 loss : 0.3185838460922241
# accuracy:84.93975903614458%
# epochs : 178 loss : 0.3184555470943451
# accuracy:84.93975903614458%
# epochs : 179 loss : 0.318329393863678
# accuracy:84.93975903614458%
# epochs : 180 loss : 0.3182029724121094
# accuracy:84.93975903614458%
# epochs : 181 loss : 0.31807374954223633
# accuracy:84.93975903614458%
# epochs : 182 loss : 0.3179614245891571
# accuracy:84.93975903614458%
# epochs : 183 loss : 0.3178441524505615
# accuracy:84.93975903614458%
# epochs : 184 loss : 0.3177267611026764
# accuracy:84.93975903614458%
# epochs : 185 loss : 0.31761032342910767
# accuracy:84.93975903614458%
# epochs : 186 loss : 0.31751391291618347
# accuracy:85.2409638554217%
# epochs : 187 loss : 0.31738200783729553
# accuracy:85.2409638554217%
# epochs : 188 loss : 0.31726786494255066
# accuracy:85.2409638554217%
# epochs : 189 loss : 0.3171864449977875
# accuracy:85.2409638554217%
# epochs : 190 loss : 0.31709399819374084
# accuracy:85.2409638554217%
# epochs : 191 loss : 0.31699293851852417
# accuracy:85.2409638554217%
# epochs : 192 loss : 0.31689906120300293
# accuracy:85.2409638554217%
# epochs : 193 loss : 0.31682083010673523
# accuracy:85.2409638554217%
# epochs : 194 loss : 0.3167310357093811
# accuracy:85.2409638554217%
# epochs : 195 loss : 0.31663861870765686
# accuracy:85.2409638554217%
# epochs : 196 loss : 0.3165593147277832
# accuracy:85.2409638554217%
# epochs : 197 loss : 0.3164653480052948
# accuracy:85.2409638554217%
# epochs : 198 loss : 0.31639254093170166
# accuracy:85.54216867469879%
# epochs : 199 loss : 0.3163069486618042
# accuracy:85.54216867469879%
# epochs : 200 loss : 0.31623223423957825
# accuracy:85.54216867469879%
# epochs : 201 loss : 0.3161622881889343
# accuracy:85.54216867469879%
# epochs : 202 loss : 0.3160959780216217
# accuracy:85.54216867469879%
# epochs : 203 loss : 0.3160247206687927
# accuracy:85.54216867469879%
# epochs : 204 loss : 0.3159657120704651
# accuracy:85.8433734939759%
# epochs : 205 loss : 0.3158974051475525
# accuracy:85.8433734939759%
# epochs : 206 loss : 0.31582576036453247
# accuracy:85.8433734939759%
# epochs : 207 loss : 0.31577542424201965
# accuracy:85.8433734939759%
# epochs : 208 loss : 0.3157132863998413
# accuracy:85.8433734939759%
# epochs : 209 loss : 0.3156539797782898
# accuracy:85.8433734939759%
# epochs : 210 loss : 0.3156011402606964
# accuracy:85.8433734939759%
# epochs : 211 loss : 0.31554991006851196
# accuracy:85.8433734939759%
# epochs : 212 loss : 0.3154914677143097
# accuracy:85.8433734939759%
# epochs : 213 loss : 0.3154371380805969
# accuracy:85.8433734939759%
# epochs : 214 loss : 0.3153854012489319
# accuracy:85.8433734939759%
# epochs : 215 loss : 0.31533539295196533
# accuracy:85.8433734939759%
# epochs : 216 loss : 0.31529223918914795
# accuracy:85.8433734939759%
# epochs : 217 loss : 0.31524893641471863
# accuracy:85.8433734939759%
# epochs : 218 loss : 0.3152002990245819
# accuracy:85.8433734939759%
# epochs : 219 loss : 0.31515994668006897
# accuracy:85.8433734939759%
# epochs : 220 loss : 0.3151112496852875
# accuracy:86.14457831325302%
# epochs : 221 loss : 0.31507235765457153
# accuracy:86.14457831325302%
# epochs : 222 loss : 0.3150307834148407
# accuracy:86.14457831325302%
# epochs : 223 loss : 0.31498467922210693
# accuracy:86.14457831325302%
# epochs : 224 loss : 0.3149467408657074
# accuracy:86.14457831325302%
# epochs : 225 loss : 0.3149069845676422
# accuracy:86.14457831325302%
# epochs : 226 loss : 0.31486982107162476
# accuracy:85.8433734939759%
# epochs : 227 loss : 0.31482475996017456
# accuracy:85.8433734939759%
# epochs : 228 loss : 0.31479203701019287
# accuracy:85.8433734939759%
# epochs : 229 loss : 0.3147490620613098
# accuracy:85.8433734939759%
# epochs : 230 loss : 0.31472694873809814
# accuracy:85.8433734939759%
# epochs : 231 loss : 0.3146853446960449
# accuracy:85.54216867469879%
# epochs : 232 loss : 0.3146592378616333
# accuracy:85.54216867469879%
# epochs : 233 loss : 0.31462234258651733
# accuracy:85.54216867469879%
# epochs : 234 loss : 0.314595103263855
# accuracy:85.54216867469879%
# epochs : 235 loss : 0.314567506313324
# accuracy:85.8433734939759%
# epochs : 236 loss : 0.3145495653152466
# accuracy:86.14457831325302%
# epochs : 237 loss : 0.3145255446434021
# accuracy:86.14457831325302%
# epochs : 238 loss : 0.3145090937614441
# accuracy:86.14457831325302%
# epochs : 239 loss : 0.31448864936828613
# accuracy:86.14457831325302%
# epochs : 240 loss : 0.3144904673099518
# accuracy:86.44578313253012%
# epochs : 241 loss : 0.31449300050735474
# accuracy:86.44578313253012%
# epochs : 242 loss : 0.3144822120666504
# accuracy:86.14457831325302%
# epochs : 243 loss : 0.3144393861293793
# accuracy:86.14457831325302%
# epochs : 244 loss : 0.3144020438194275
# accuracy:86.14457831325302%
# epochs : 245 loss : 0.3143649697303772
# accuracy:86.44578313253012%
# epochs : 246 loss : 0.314331978559494
# accuracy:86.44578313253012%
# epochs : 247 loss : 0.3143065273761749
# accuracy:86.44578313253012%
# epochs : 248 loss : 0.31428390741348267
# accuracy:86.44578313253012%
# epochs : 249 loss : 0.3142656087875366
# accuracy:86.44578313253012%
# epochs : 250 loss : 0.3142460286617279
# accuracy:86.44578313253012%
# epochs : 251 loss : 0.31422340869903564
# accuracy:86.44578313253012%
# epochs : 252 loss : 0.31418874859809875
# accuracy:86.44578313253012%
# epochs : 253 loss : 0.3141622841358185
# accuracy:86.44578313253012%
# epochs : 254 loss : 0.31414154171943665
# accuracy:86.44578313253012%
# epochs : 255 loss : 0.31412142515182495
# accuracy:86.44578313253012%
# epochs : 256 loss : 0.3140982687473297
# accuracy:86.44578313253012%
# epochs : 257 loss : 0.3140886127948761
# accuracy:86.44578313253012%
# epochs : 258 loss : 0.3140626549720764
# accuracy:86.44578313253012%
# epochs : 259 loss : 0.3140442967414856
# accuracy:86.44578313253012%
# epochs : 260 loss : 0.3140324354171753
# accuracy:86.44578313253012%
# epochs : 261 loss : 0.3140106797218323
# accuracy:86.44578313253012%
# epochs : 262 loss : 0.3139949142932892
# accuracy:86.44578313253012%
# epochs : 263 loss : 0.3139844536781311
# accuracy:86.44578313253012%
# epochs : 264 loss : 0.3139655590057373
# accuracy:86.44578313253012%
# epochs : 265 loss : 0.31395223736763
# accuracy:86.44578313253012%
# epochs : 266 loss : 0.3139403164386749
# accuracy:86.74698795180723%
# epochs : 267 loss : 0.31392306089401245
# accuracy:86.74698795180723%
# epochs : 268 loss : 0.3139084279537201
# accuracy:86.74698795180723%
# epochs : 269 loss : 0.31389737129211426
# accuracy:86.74698795180723%
# epochs : 270 loss : 0.31388065218925476
# accuracy:86.44578313253012%
# epochs : 271 loss : 0.3138680160045624
# accuracy:86.44578313253012%
# epochs : 272 loss : 0.3138599097728729
# accuracy:86.44578313253012%
# epochs : 273 loss : 0.3138434588909149
# accuracy:86.74698795180723%
# epochs : 274 loss : 0.3138347566127777
# accuracy:86.74698795180723%
# epochs : 275 loss : 0.31382429599761963
# accuracy:86.74698795180723%
# epochs : 276 loss : 0.31381288170814514
# accuracy:86.74698795180723%
# epochs : 277 loss : 0.3138006031513214
# accuracy:86.74698795180723%
# epochs : 278 loss : 0.3137892782688141
# accuracy:86.74698795180723%
# epochs : 279 loss : 0.3137820363044739
# accuracy:86.74698795180723%
# epochs : 280 loss : 0.31377115845680237
# accuracy:86.74698795180723%
# epochs : 281 loss : 0.3137596547603607
# accuracy:86.74698795180723%
# epochs : 282 loss : 0.3137527108192444
# accuracy:86.74698795180723%
# epochs : 283 loss : 0.313738077878952
# accuracy:86.74698795180723%
# epochs : 284 loss : 0.31373143196105957
# accuracy:86.74698795180723%
# epochs : 285 loss : 0.31372421979904175
# accuracy:86.74698795180723%
# epochs : 286 loss : 0.31371331214904785
# accuracy:86.74698795180723%
# epochs : 287 loss : 0.31370460987091064
# accuracy:86.74698795180723%
# epochs : 288 loss : 0.3136988580226898
# accuracy:86.74698795180723%
# epochs : 289 loss : 0.3136877119541168
# accuracy:86.74698795180723%
# epochs : 290 loss : 0.3136800527572632
# accuracy:86.74698795180723%
# epochs : 291 loss : 0.31367185711860657
# accuracy:86.74698795180723%
# epochs : 292 loss : 0.31366628408432007
# accuracy:86.74698795180723%
# epochs : 293 loss : 0.313655823469162
# accuracy:86.74698795180723%
# epochs : 294 loss : 0.3136478066444397
# accuracy:86.74698795180723%
# epochs : 295 loss : 0.31364259123802185
# accuracy:86.74698795180723%
# epochs : 296 loss : 0.313633531332016
# accuracy:86.74698795180723%
# epochs : 297 loss : 0.31362420320510864
# accuracy:86.74698795180723%
# epochs : 298 loss : 0.31362184882164
# accuracy:86.74698795180723%
# epochs : 299 loss : 0.31361252069473267
# accuracy:86.74698795180723%
# epochs : 300 loss : 0.3136044442653656
# accuracy:86.74698795180723%
# epochs : 301 loss : 0.31359928846359253
# accuracy:86.74698795180723%
# epochs : 302 loss : 0.31359362602233887
# accuracy:86.74698795180723%
# epochs : 303 loss : 0.3135870099067688
# accuracy:86.74698795180723%
# epochs : 304 loss : 0.313581258058548
# accuracy:86.74698795180723%
# epochs : 305 loss : 0.31357359886169434
# accuracy:87.04819277108435%
# epochs : 306 loss : 0.3135702908039093
# accuracy:86.74698795180723%
# epochs : 307 loss : 0.31356313824653625
# accuracy:87.04819277108435%
# epochs : 308 loss : 0.3135591447353363
# accuracy:87.04819277108435%
# epochs : 309 loss : 0.3135524094104767
# accuracy:87.04819277108435%
# epochs : 310 loss : 0.3135474622249603
# accuracy:87.04819277108435%
# epochs : 311 loss : 0.3135411739349365
# accuracy:87.04819277108435%
# epochs : 312 loss : 0.3135387599468231
# accuracy:87.04819277108435%
# epochs : 313 loss : 0.31353193521499634
# accuracy:87.04819277108435%
# epochs : 314 loss : 0.3135262131690979
# accuracy:87.04819277108435%
# epochs : 315 loss : 0.3135240077972412
# accuracy:87.04819277108435%
# epochs : 316 loss : 0.3135182559490204
# accuracy:87.04819277108435%
# epochs : 317 loss : 0.3135125935077667
# accuracy:87.04819277108435%
# epochs : 318 loss : 0.31350892782211304
# accuracy:87.04819277108435%
# epochs : 319 loss : 0.3135044276714325
# accuracy:87.04819277108435%
# epochs : 320 loss : 0.31349867582321167
# accuracy:87.04819277108435%
# epochs : 321 loss : 0.3134958744049072
# accuracy:87.04819277108435%
# epochs : 322 loss : 0.3134913444519043
# accuracy:87.04819277108435%
# epochs : 323 loss : 0.31348559260368347
# accuracy:87.04819277108435%
# epochs : 324 loss : 0.31348323822021484
# accuracy:87.04819277108435%
# epochs : 325 loss : 0.31347793340682983
# accuracy:87.04819277108435%
# epochs : 326 loss : 0.3134744465351105
# accuracy:87.04819277108435%
# epochs : 327 loss : 0.3134687840938568
# accuracy:87.04819277108435%
# epochs : 328 loss : 0.3134661614894867
# accuracy:87.04819277108435%
# epochs : 329 loss : 0.3134608566761017
# accuracy:87.04819277108435%
# epochs : 330 loss : 0.31345605850219727
# accuracy:87.04819277108435%
# epochs : 331 loss : 0.3134539723396301
# accuracy:87.04819277108435%
# epochs : 332 loss : 0.3134494423866272
# accuracy:87.04819277108435%
# epochs : 333 loss : 0.31344524025917053
# accuracy:87.04819277108435%
# epochs : 334 loss : 0.3134424686431885
# accuracy:87.04819277108435%
# epochs : 335 loss : 0.313438355922699
# accuracy:87.04819277108435%
# epochs : 336 loss : 0.31343498826026917
# accuracy:87.34939759036145%
# epochs : 337 loss : 0.31343314051628113
# accuracy:87.04819277108435%
# epochs : 338 loss : 0.31342852115631104
# accuracy:87.34939759036145%
# epochs : 339 loss : 0.31342679262161255
# accuracy:87.04819277108435%
# epochs : 340 loss : 0.3134225904941559
# accuracy:87.34939759036145%
# epochs : 341 loss : 0.3134212791919708
# accuracy:87.04819277108435%
# epochs : 342 loss : 0.3134171962738037
# accuracy:87.04819277108435%
# epochs : 343 loss : 0.31341397762298584
# accuracy:87.04819277108435%
# epochs : 344 loss : 0.31341126561164856
# accuracy:87.04819277108435%
# epochs : 345 loss : 0.3134084939956665
# accuracy:87.34939759036145%
# epochs : 346 loss : 0.3134070932865143
# accuracy:87.04819277108435%
# epochs : 347 loss : 0.3134038746356964
# accuracy:87.04819277108435%
# epochs : 348 loss : 0.31340211629867554
# accuracy:87.04819277108435%
# epochs : 349 loss : 0.31339898705482483
# accuracy:87.04819277108435%
# epochs : 350 loss : 0.31339654326438904
# accuracy:87.04819277108435%
# epochs : 351 loss : 0.3133929669857025
# accuracy:87.04819277108435%
# epochs : 352 loss : 0.3133915066719055
# accuracy:87.04819277108435%
# epochs : 353 loss : 0.3133890628814697
# accuracy:87.04819277108435%
# epochs : 354 loss : 0.3133876621723175
# accuracy:87.04819277108435%
# epochs : 355 loss : 0.3133853077888489
# accuracy:87.04819277108435%
# epochs : 356 loss : 0.31338250637054443
# accuracy:87.04819277108435%
# epochs : 357 loss : 0.3133801519870758
# accuracy:87.04819277108435%
# epochs : 358 loss : 0.3133784234523773
# accuracy:87.04819277108435%
# epochs : 359 loss : 0.31337666511535645
# accuracy:87.04819277108435%
# epochs : 360 loss : 0.3133743405342102
# accuracy:87.34939759036145%
# epochs : 361 loss : 0.313372403383255
# accuracy:87.04819277108435%
# epochs : 362 loss : 0.3133699595928192
# accuracy:87.04819277108435%
# epochs : 363 loss : 0.31336864829063416
# accuracy:87.04819277108435%
# epochs : 364 loss : 0.31336647272109985
# accuracy:87.04819277108435%
# epochs : 365 loss : 0.3133643865585327
# accuracy:87.04819277108435%
# epochs : 366 loss : 0.3133634328842163
# accuracy:87.04819277108435%
# epochs : 367 loss : 0.3133609890937805
# accuracy:87.34939759036145%
# epochs : 368 loss : 0.31335940957069397
# accuracy:87.34939759036145%
# epochs : 369 loss : 0.3133575916290283
# accuracy:87.34939759036145%
# epochs : 370 loss : 0.31335628032684326
# accuracy:87.34939759036145%
# epochs : 371 loss : 0.3133541941642761
# accuracy:87.34939759036145%
# epochs : 372 loss : 0.3133527934551239
# accuracy:87.04819277108435%
# epochs : 373 loss : 0.31335148215293884
# accuracy:86.44578313253012%
# epochs : 374 loss : 0.31334948539733887
# accuracy:86.44578313253012%
# epochs : 375 loss : 0.31334784626960754
# accuracy:86.44578313253012%
# epochs : 376 loss : 0.3133464455604553
# accuracy:86.44578313253012%
# epochs : 377 loss : 0.3133448660373688
# accuracy:86.44578313253012%
# epochs : 378 loss : 0.3133433759212494
# accuracy:86.44578313253012%
# epochs : 379 loss : 0.31334182620048523
# accuracy:86.44578313253012%
# epochs : 380 loss : 0.31334078311920166
# accuracy:86.74698795180723%
# epochs : 381 loss : 0.3133399188518524
# accuracy:86.74698795180723%
# epochs : 382 loss : 0.31333860754966736
# accuracy:86.74698795180723%
# epochs : 383 loss : 0.3133378028869629
# accuracy:86.74698795180723%
# epochs : 384 loss : 0.31333693861961365
# accuracy:86.74698795180723%
# epochs : 385 loss : 0.3133366107940674
# accuracy:87.04819277108435%
# epochs : 386 loss : 0.3133372962474823
# accuracy:87.65060240963855%
# epochs : 387 loss : 0.3133385181427002
# accuracy:87.95180722891565%
# epochs : 388 loss : 0.3133368492126465
# accuracy:87.65060240963855%
# epochs : 389 loss : 0.3133360743522644
# accuracy:87.65060240963855%
# epochs : 390 loss : 0.3133346736431122
# accuracy:87.95180722891565%
# epochs : 391 loss : 0.31333380937576294
# accuracy:87.34939759036145%
# epochs : 392 loss : 0.3133322298526764
# accuracy:87.95180722891565%
# epochs : 393 loss : 0.31333082914352417
# accuracy:87.34939759036145%
# epochs : 394 loss : 0.31332963705062866
# accuracy:87.04819277108435%
# epochs : 395 loss : 0.3133285641670227
# accuracy:87.34939759036145%
# epochs : 396 loss : 0.3133278787136078
# accuracy:87.34939759036145%
# epochs : 397 loss : 0.3133266568183899
# accuracy:87.34939759036145%
# epochs : 398 loss : 0.313325434923172
# accuracy:87.34939759036145%
# epochs : 399 loss : 0.3133242130279541
# accuracy:87.34939759036145%
# epochs : 400 loss : 0.31332334876060486
# accuracy:87.34939759036145%
# epochs : 401 loss : 0.3133225739002228
# accuracy:87.34939759036145%
# epochs : 402 loss : 0.31332167983055115
# accuracy:87.04819277108435%
# epochs : 403 loss : 0.31332045793533325
# accuracy:87.34939759036145%
# epochs : 404 loss : 0.313319593667984
# accuracy:87.04819277108435%
# epochs : 405 loss : 0.31331881880760193
# accuracy:86.74698795180723%
# epochs : 406 loss : 0.31331777572631836
# accuracy:86.74698795180723%
# epochs : 407 loss : 0.3133167326450348
# accuracy:87.04819277108435%
# epochs : 408 loss : 0.3133159279823303
# accuracy:87.04819277108435%
# epochs : 409 loss : 0.31331533193588257
# accuracy:87.04819277108435%
# epochs : 410 loss : 0.3133141100406647
# accuracy:87.04819277108435%
# epochs : 411 loss : 0.3133140206336975
# accuracy:87.04819277108435%
# epochs : 412 loss : 0.3133123815059662
# accuracy:87.04819277108435%
# epochs : 413 loss : 0.3133115768432617
# accuracy:87.04819277108435%
# epochs : 414 loss : 0.3133106231689453
# accuracy:87.04819277108435%
# epochs : 415 loss : 0.31331008672714233
# accuracy:87.04819277108435%
# epochs : 416 loss : 0.3133088946342468
# accuracy:86.74698795180723%
# epochs : 417 loss : 0.31330835819244385
# accuracy:87.04819277108435%
# epochs : 418 loss : 0.3133073151111603
# accuracy:87.04819277108435%
# epochs : 419 loss : 0.31330662965774536
# accuracy:87.04819277108435%
# epochs : 420 loss : 0.3133058249950409
# accuracy:87.34939759036145%
# epochs : 421 loss : 0.31330522894859314
# accuracy:87.34939759036145%
# epochs : 422 loss : 0.31330469250679016
# accuracy:87.34939759036145%
# epochs : 423 loss : 0.31330356001853943
# accuracy:87.34939759036145%
# epochs : 424 loss : 0.31330305337905884
# accuracy:87.34939759036145%
# epochs : 425 loss : 0.3133021593093872
# accuracy:87.34939759036145%
# epochs : 426 loss : 0.31330156326293945
# accuracy:87.65060240963855%
# epochs : 427 loss : 0.3133006989955902
# accuracy:87.34939759036145%
# epochs : 428 loss : 0.31330034136772156
# accuracy:87.34939759036145%
# epochs : 429 loss : 0.3132992088794708
# accuracy:87.34939759036145%
# epochs : 430 loss : 0.3132990300655365
# accuracy:87.34939759036145%
# epochs : 431 loss : 0.31329798698425293
# accuracy:87.34939759036145%
# epochs : 432 loss : 0.31329771876335144
# accuracy:87.34939759036145%
# epochs : 433 loss : 0.31329676508903503
# accuracy:87.65060240963855%
# epochs : 434 loss : 0.3132963180541992
# accuracy:87.34939759036145%
# epochs : 435 loss : 0.31329581141471863
# accuracy:87.65060240963855%
# epochs : 436 loss : 0.31329527497291565
# accuracy:87.34939759036145%
# epochs : 437 loss : 0.3132949471473694
# accuracy:87.65060240963855%
# epochs : 438 loss : 0.31329405307769775
# accuracy:87.65060240963855%
# epochs : 439 loss : 0.3132937252521515
# accuracy:87.34939759036145%
# epochs : 440 loss : 0.313292920589447
# accuracy:87.65060240963855%
# epochs : 441 loss : 0.31329283118247986
# accuracy:87.34939759036145%
# epochs : 442 loss : 0.31329214572906494
# accuracy:87.65060240963855%
# epochs : 443 loss : 0.3132915496826172
# accuracy:87.95180722891565%
# epochs : 444 loss : 0.31329119205474854
# accuracy:87.34939759036145%
# epochs : 445 loss : 0.31329092383384705
# accuracy:87.65060240963855%
# epochs : 446 loss : 0.3132898807525635
# accuracy:87.34939759036145%
# epochs : 447 loss : 0.313289612531662
# accuracy:87.95180722891565%
# epochs : 448 loss : 0.31328901648521423
# accuracy:87.65060240963855%
# epochs : 449 loss : 0.3132888376712799
# accuracy:87.95180722891565%
# epochs : 450 loss : 0.313288152217865
# accuracy:87.95180722891565%
# epochs : 451 loss : 0.3132880628108978
# accuracy:87.65060240963855%
# epochs : 452 loss : 0.31328752636909485
# accuracy:87.65060240963855%
# epochs : 453 loss : 0.3132869303226471
# accuracy:87.65060240963855%
# epochs : 454 loss : 0.31328675150871277
# accuracy:87.65060240963855%
# epochs : 455 loss : 0.3132862150669098
# accuracy:87.95180722891565%
# epochs : 456 loss : 0.3132858872413635
# accuracy:87.65060240963855%
# epochs : 457 loss : 0.3132852613925934
# accuracy:87.95180722891565%
# epochs : 458 loss : 0.3132851719856262
# accuracy:87.65060240963855%
# epochs : 459 loss : 0.31328466534614563
# accuracy:87.65060240963855%
# epochs : 460 loss : 0.3132844865322113
# accuracy:87.65060240963855%
# epochs : 461 loss : 0.31328412890434265
# accuracy:87.65060240963855%
# epochs : 462 loss : 0.31328362226486206
# accuracy:87.65060240963855%
# epochs : 463 loss : 0.3132832646369934
# accuracy:87.65060240963855%
# epochs : 464 loss : 0.3132829964160919
# accuracy:87.65060240963855%
# epochs : 465 loss : 0.3132825791835785
# accuracy:87.65060240963855%
# epochs : 466 loss : 0.31328222155570984
# accuracy:87.65060240963855%
# epochs : 467 loss : 0.31328222155570984
# accuracy:87.65060240963855%
# epochs : 468 loss : 0.31328150629997253
# accuracy:87.95180722891565%
# epochs : 469 loss : 0.31328141689300537
# accuracy:87.95180722891565%
# epochs : 470 loss : 0.31328099966049194
# accuracy:87.95180722891565%
# epochs : 471 loss : 0.31328099966049194
# accuracy:87.95180722891565%
# epochs : 472 loss : 0.3132806420326233
# accuracy:87.95180722891565%
# epochs : 473 loss : 0.3132801949977875
# accuracy:87.95180722891565%
# epochs : 474 loss : 0.3132799565792084
# accuracy:87.95180722891565%
# epochs : 475 loss : 0.3132795989513397
# accuracy:87.95180722891565%
# epochs : 476 loss : 0.31327933073043823
# accuracy:87.95180722891565%
# epochs : 477 loss : 0.31327909231185913
# accuracy:87.95180722891565%
# epochs : 478 loss : 0.31327882409095764
# accuracy:87.95180722891565%
# epochs : 479 loss : 0.3132786452770233
# accuracy:87.95180722891565%
# epochs : 480 loss : 0.3132783770561218
# accuracy:87.95180722891565%
# epochs : 481 loss : 0.3132780194282532
# accuracy:87.95180722891565%
# epochs : 482 loss : 0.3132780194282532
# accuracy:87.95180722891565%
# epochs : 483 loss : 0.31327760219573975
# accuracy:87.95180722891565%
# epochs : 484 loss : 0.3132774233818054
# accuracy:87.95180722891565%
# epochs : 485 loss : 0.31327706575393677
# accuracy:87.95180722891565%
# epochs : 486 loss : 0.3132769763469696
# accuracy:87.95180722891565%
# epochs : 487 loss : 0.31327664852142334
# accuracy:87.95180722891565%
# epochs : 488 loss : 0.3132765591144562
# accuracy:87.95180722891565%
# epochs : 489 loss : 0.3132762908935547
# accuracy:87.95180722891565%
# epochs : 490 loss : 0.31327611207962036
# accuracy:87.95180722891565%
# epochs : 491 loss : 0.31327593326568604
# accuracy:87.95180722891565%
# epochs : 492 loss : 0.3132757544517517
# accuracy:87.95180722891565%
# epochs : 493 loss : 0.3132753372192383
# accuracy:87.95180722891565%
# epochs : 494 loss : 0.3132753372192383
# accuracy:87.95180722891565%
# epochs : 495 loss : 0.3132750689983368
# accuracy:87.95180722891565%
# epochs : 496 loss : 0.3132748007774353
# accuracy:87.95180722891565%
# epochs : 497 loss : 0.31327447295188904
# accuracy:88.25301204819277%
# epochs : 498 loss : 0.31327447295188904
# accuracy:87.95180722891565%
# epochs : 499 loss : 0.3132741153240204

# titanic survival rate
# accuracy 87~88%